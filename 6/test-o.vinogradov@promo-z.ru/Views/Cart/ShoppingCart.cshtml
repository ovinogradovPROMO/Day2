@using AdvantShop.Orders

@model AdvantShop.ViewModel.Common.ShoppingCartViewModel

<div class="site-head-cart">
    @Html.Action("ClientCode", "User")
    <div class="cart-mini" data-cart-mini>
        <div data-cart-mini-list data-cart-data="cartMini.cartData"></div>
        <a data-cart-mini-trigger href="@Url.RouteUrl("Cart")" class="cs-l-2 cart-mini-main-link">
            <svg version="1.1" width="28" height="29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                 viewBox="0 0 612 570" style="enable-background:new 0 0 612 570;" xml:space="preserve">
            <path fill="currentColor" d="M608.5,103.5c-3.2-3.9-8.1-6.2-13.2-6.2H107.6L91.4,13.8C89.9,5.8,82.8,0,74.7,0H17.1C7.6,0,0,7.6,0,17.1
			    s7.6,17.1,17.1,17.1h43.5l73.5,384.3c1.4,8.2,8.5,14.1,16.8,14.1h60.3c-32.4,5.9-57,34.2-57,68.2c0,38.2,31.1,69.3,69.4,69.3
			    c38.3,0,69.4-31.1,69.4-69.3c0-34-24.6-62.3-57-68.2h221.6c-32.4,5.9-57,34.2-57,68.2c0,38.2,31.1,69.3,69.4,69.3
			    c38.3,0,69.4-31.1,69.4-69.3c0-34-24.6-62.3-57-68.2h52c9.4,0,17.1-7.6,17.1-17.1c0-9.4-7.6-17.1-17.1-17.1H165.2l-5.2-29.7h388.2
			    c8.1,0,15.2-5.8,16.7-13.7L612,117.6C613,112.6,611.7,107.4,608.5,103.5z M505.2,500.7c0,19.4-15.8,35.2-35.2,35.2
			    c-19.4,0-35.3-15.8-35.3-35.2s15.8-35.2,35.3-35.2C489.4,465.4,505.2,481.2,505.2,500.7z M258.8,500.7c0,19.4-15.8,35.2-35.2,35.2
			    c-19.4,0-35.3-15.8-35.3-35.2s15.8-35.2,35.3-35.2C243,465.4,258.8,481.2,258.8,500.7z M153.6,334.5l-23.1-119.3h64.4l19.6,119.3
			    H153.6z M327.3,334.5h-78.2l-19.6-119.3h97.8V334.5z M440.8,334.5h-79.4V215.2H458L440.8,334.5z M534.1,334.5h-58.8l17.1-119.3
			    h65.4L534.1,334.5z M564.6,181.1H123.9l-9.7-49.8h460.3L564.6,181.1z" />

            </svg>
            <span class="cart-mini-count" data-cart-count data-ng-bind-html="cartCount.getValue()">@ShoppingCartService.CurrentShoppingCart.TotalItems</span>
        </a>
    </div>
</div>
<script type="text/ng-template" id="/scripts/_partials/cart/templates/cart-mini.html">
        <div class="cart-mini-block js-cart-mini-block"
             data-ng-show="cartMiniList.isVisibleCart === true"
             data-ng-class="{'cart-mini-fixed': cartMiniList.isCartMiniFixed, 'cart-mini-active': cartMiniList.isVisibleCart === true}"
             data-ng-style="{'left': cartMiniList.isCartMiniFixed === true ? cartMiniList.staticPosition.left : 'auto', 'width': cartMiniList.isCartMiniFixed === true ? cartMiniList.staticPosition.width : 'auto'}">
            <div class="cart-mini-scrollbar-block" data-window-click="cartMiniList.clickOut(event)">
                <div class="cart-mini-scrollbar">
                    <ul class="cart-mini-list" data-window-scroll="cartMiniList.windowScroll(event)">
                        <li class="cart-mini-item" data-ng-repeat="item in cartMiniList.cartData.CartProducts track by $index">
                            <div class="row">
                                <div class="col-xs-3">
                                    <figure class="cart-mini-photo">
                                        <a class="cart-mini-photo-link" href="{{::item.Link}}"><img data-ng-src="{{::item.PhotoPath}}" alt="{{::item.PhotoAlt}}" /></a>
                                    </figure>
                                </div>
                                <div class="col-xs-9">
                                    <div class="cart-mini-info">
                                        <div class="cart-mini-name">
                                            <a href="{{::item.Link}}" class="cart-mini-name-link" data-ng-bind="::item.Name"></a>
                                        </div>
                                        <div class="cart-mini-count">
                                            <span class="cart-mini-count-text cs-t-3">{{ ::'Js.Cart.Amount' | translate }}:</span> <span class="cart-mini-count-value" data-ng-bind="item.Amount"></span>
                                        </div>
                                        <div class="cart-mini-price">
                                            <span class="cart-mini-price-text cs-t-3">{{ ::'Js.Cart.Price' | translate }}:</span> <span class="cart-mini-price-value" data-ng-bind="::item.PriceWithDiscount"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="cart-mini-result-block">
                <div class="cart-mini-result-row" data-ng-if="cartMiniList.cartData.TotalProductPrice != null" data-ng-show="cartMiniList.cartData.TotalPrice != cartMiniList.cartData.TotalProductPrice">
                    <span class="cart-mini-result-name">{{ ::'Js.Cart.Sum' | translate }}:</span> <span class="cart-mini-result-value" data-ng-bind="cartMiniList.cartData.TotalProductPrice"></span>
                </div>
                <div class="cart-mini-result-row" data-ng-if="cartMiniList.cartData.DiscountPrice != null" data-ng-show="cartMiniList.cartData.DiscountPrice != null">
                    <span class="cart-mini-result-name">{{ ::'Js.Cart.Discount' | translate }}:</span> <span class="cart-mini-result-value" data-ng-bind="cartMiniList.cartData.DiscountPrice"></span>
                </div>
                <div class="cart-mini-result-row" data-ng-if="cartMiniList.cartData.Certificate != null">
                    <span class="cart-mini-result-name">{{ ::'Js.Cart.Certificate' | translate }}:</span> <span class="cart-mini-result-value" data-ng-bind="cartMiniList.cartData.Certificate"></span>
                </div>
                <div class="cart-mini-result-row" data-ng-if="cartMiniList.cartData.Coupon != null">
                    <span class="cart-mini-result-name">{{ ::'Js.Cart.Coupon' | translate }}:</span> <span class="cart-mini-result-value" data-ng-bind="cartMiniList.cartData.Coupon.Price"></span>
                </div>
                <div class="cart-mini-result-row" data-ng-if="cartMiniList.cartData.TotalPrice != null">
                    <span class="cart-mini-result-name">{{ ::'Js.Cart.Total' | translate }}:</span> <span class="cart-mini-result-value" data-ng-bind="cartMiniList.cartData.TotalPrice"></span>
                </div>
                <div class="cart-mini-buttons">
                    <a data-ng-if="::cartMiniList.cartData.ShowConfirmButtons" href="cart" class="btn btn-buy btn-xsmall">
                        {{ ::'Js.Cart.Cart' | translate }}
                    </a>
                    <a href="checkout" class="btn btn-action btn-xsmall">
                        {{ ::'Js.Cart.Checkout' | translate }}
                    </a>
                </div>
            </div>
        </div>
</script>